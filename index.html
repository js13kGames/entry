<!DOCTYPE html>
<html>

<head>
  <title>Return</title>
  <script src="https://js13kgames.com/webxr-src/aframe.js"></script>
  
  <!-- build:js -->
  <script src="components/button.js"></script>
  <script src="components/logic.js"></script>
  <script src="components/star.js"></script>
  <!-- endbuild -->
</head>

<body>
  <a-scene background="color: #141414" logic>

    <a-assets>
      <a-asset-item id="cockpit" src="models/cockpit_v2.obj"></a-asset-item>
    </a-assets>

    <a-entity id="startMenu" visible="false">
      <a-text value="Return" position="0 1.4 -1" align="center" anchor="center"></a-text>
      <a-plane id="playButton" class="clickable" position="0 1 -1" width="0.5" height="0.2">
        <a-text value="Play!" align="center" anchor="center" width="3"></a-text>
      </a-plane>
    </a-entity>

    <a-entity id="gameOverMenu" visible="false">
      <a-text value="Game Over!" position="0 1.4 -1" align="center" anchor="center"></a-text>
      <a-plane id="retryButton" class="clickable" position="0 1 -1" width="0.5" height="0.2">
        <a-text value="Retry" align="center" anchor="center" width="3"></a-text>
      </a-plane>
    </a-entity>

    <a-entity id="winMenu" visible="false">
      <a-text value="You win!" position="0 1.4 -1" align="center" anchor="center"></a-text>
      <a-plane id="playAgainButton" class="clickable" position="0 1 -1" width="0.7" height="0.2">
        <a-text value="Play again" align="center" anchor="center" width="3"></a-text>
      </a-plane>
    </a-entity>

    <a-entity id="game">
      <a-sphere 
        position="5 2 -6"
        radius=5
        color="#fd8" 
        material="emissive: #f8a300; emissiveIntensity: .7"
        light="castShadow: true">
      </a-sphere>
    
      <!-- Container for ship items -->
      <a-entity id="ship">
        <a-entity rotation="0 -90 0" obj-model="obj: #cockpit" material="color: #3f3f3f" shadow></a-entity>

        <!-- Front panel -->
        <a-entity position="0 .8 -1.75" rotation="-51.34 0 0">
          <a-box postition="0 0 -0.1" height=".3" width=".3" depth=".1" shadow>
            <a-cylinder 
              id="launchButton"
              class="clickable" 
              color="red" 
              height=".1"
              radius=".1" 
              position="0 0 .05" 
              rotation="90 0 0" 
              shadow 
              button="pressed: true"
              animation__in="property: object3D.position.z; startEvents: in; from: .05; to: .01; dur: 100"
              animation__out="property: object3D.position.z; startEvents: out; from: .01; to: .05; dur: 100"></a-cylinder>
          </a-box>

          <a-plane id="fuelGuage" color="#0f0" position="-.3 0 .01" width=".1" height=".5"></a-plane>
          <a-plane color="#000" position="-.3 0 .009" width=".1" height=".5"></a-plane>

          <a-plane id="jumpCostGuage" color="#00f" position=".3 0 .01" width=".1" height=".5"></a-plane>
          <a-plane color="#000" position=".3 0 .009" width=".1" height=".5"></a-plane>
        </a-entity>

        <!-- Map panel -->
        <a-plane id="map" color="#333" height="1" width="1.5" position="1.2 1.25 0" rotation="0 -90 0" opacity="0.8" shadow>
          <!-- <a-entity text="value: Fuel:; anchor: left; baseline: top; transparent: false; width: 2" position="-.7 .35 0"></a-entity>
          <a-plane position=".12 .32 .001" color="green" height=".07" width="1.18"></a-plane> -->

          <!-- <a-circle position="0 0 0.001" color="yellow" radius="0.05"></a-circle>
          <a-circle position="0.1 0 0.001" color="brown" radius="0.02"></a-circle> -->
          <a-entity id="location" position="0 0 .003" visible="false">
            <!-- Top Right -->
            <a-plane width=".03" height=".01"></a-plane>
            <a-plane width=".01" height=".03"></a-plane>
            
            <!-- Bottom Right -->
            <a-plane width=".03" height=".01"></a-plane>
            <a-plane width=".01" height=".03"></a-plane>

            <!-- Bottom Left -->
            <a-plane width=".03" height=".01"></a-plane>
            <a-plane width=".01" height=".03"></a-plane>

            <!-- Top left -->
            <a-plane width=".03" height=".01"></a-plane>
            <a-plane width=".01" height=".03"></a-plane>
          </a-entity>

          <a-entity id="target" position="0 0 .003" visible="false">
            <!-- Top -->
            <a-plane width=".01" height=".02"></a-plane>
            <!-- Right -->
            <a-plane width=".02" height=".01"></a-plane>
            <!-- Bottom -->
            <a-plane width=".01" height=".02"></a-plane>
            <!-- Left -->
            <a-plane width=".02" height=".01"></a-plane>
          </a-entity>

          <a-entity id="mapObjects"></a-entity>
        </a-plane>

        <!-- Left panel -->
        <a-box position="-1.26 .79 .25" rotation="-52 90 0" height=".3" width=".3" depth=".1" shadow>
          <a-cylinder
              id="scanButton"
              class="clickable" 
              color="blue" 
              height=".1"
              radius=".1" 
              position="0 0 .05" 
              rotation="90 0 0" 
              shadow 
              button="resetTime: 100"
              animation__in="property: object3D.position.z; startEvents: in; from: .05; to: .01; dur: 100"
              animation__out="property: object3D.position.z; startEvents: out; from: .01; to: .05; dur: 100"></a-cylinder>
        </a-box>
        <a-box position="-1.26 .79 -.25" rotation="-52 90 0" height=".3" width=".3" depth=".1" shadow>
          <a-cylinder 
              id="scoopButton"
              class="clickable" 
              color="yellow" 
              height=".1"
              radius=".1" 
              position="0 0 .05" 
              rotation="90 0 0" 
              shadow 
              button="resetTime: 100"
              animation__in="property: object3D.position.z; startEvents: in; from: .05; to: .01; dur: 100"
              animation__out="property: object3D.position.z; startEvents: out; from: .01; to: .05; dur: 100"></a-cylinder>
        </a-box>
      </a-entity>
    </a-entity>

      <!-- Camera -->
    <a-entity id="cameraRig" rotation="0 0 0">
      <a-entity camera look-controls="pointerLockEnabled: true" position="0 1.2 0">
        <a-entity id="cursor" cursor="fuse: false" position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.0001; radiusOuter: 0.005" material="color: white; shader: flat"
          raycaster="objects: #game .clickable"
          animation__mouseenter__inner="property: geometry.radiusInner; startEvents: mouseenter; easing: easeInCubic; dur: 150; from: 0.0001; to: 0.02"
          animation__mouseenter__outer="property: geometry.radiusOuter; startEvents: mouseenter; easing: easeInCubic; dur: 150; from: 0.005; to: 0.025"
          animation__mouseleave__inner="property: geometry.radiusInner; startEvents: mouseleave; easing: easeInCubic; dur: 300; from: 0.02; to: 0.0001"
          animation__mouseleave__outer="property: geometry.radiusOuter; startEvents: mouseleave; easing: easeInCubic; dur: 300; from: 0.025; to: 0.005">
        </a-entity>
        <a-sky id="mask" color="#111" opacity="0" radius="0.25" fader
          animation__out="property: material.opacity; startEvents: fadeOut; from: 0; to: 1; dur: 1000"
          animation__in="property: material.opacity; startEvents: fadeIn; from: 1; to: 0; dur: 1000">
        </a-sky>
      </a-entity>
    </a-entity>

    <!-- Lights -->
    <a-light position="0 1.8 0" intensity=".3" light="castShadow: true"></a-light>
    <a-light type="ambient" color="#d2e3fc" intensity=".5"></a-light>

    <a-entity stars></a-entity>

  </a-scene>
</body>

</html>