var c=["2d"];c.raw=c.slice();x=game.getContext(c);level=5;playermovex=playery=playerx=0;playermovey=1;horborder=200;flipy=9E3;flipped=1;paused=!1;direction=1;cameray=0;var d=Zdog.i;obstacle=[0];shakeduration=shakey=shakex=0;bgcolor="#223e32";var e=[],f;illo=new Zdog.h({element:".zdog-canvas",m:!1,zoom:2,resize:!0,rotate:{x:-(d/16),y:d/16},o:function(a){a.beginPath();a.rect(-1080,-1080,2160,2160);a.fillStyle=bgcolor;a.fill()}});player=new Zdog.g({a:illo,transform:{z:25}});
new Zdog.c({a:player,stroke:24,color:"#04bf00"});new Zdog.c({a:player,stroke:5,color:"#fff",translate:{z:5},path:[{x:-6,y:-10},{x:-6,y:0},{move:{x:6,y:-10}},{x:6,y:0}]});new Zdog.c({a:player,stroke:5,color:"#04bf00",translate:{y:16,z:5},path:[{x:-6,y:-10},{x:-6,y:0},{x:-10,y:0},{move:{x:6,y:-10}},{x:6,y:0},{x:10,y:0}]});new Zdog.c({a:illo,stroke:8,color:"#9db800",path:[{x:-horborder-10,y:-1E3},{x:-horborder-10,y:1E3},{move:{x:horborder+10,y:-1E3}},{x:horborder+10,y:1E3}]});g();var k=level;level=k;
l=1E3*k;if(1<obstacle.length)for(var m=0;m==obstacle.length;m++)obstacle[m].remove();flipped=1;playermovex=playery=playerx=0;direction=playermovey=1;var n=2*k+1;for(m=0;m!=n;m++){var q=p()*(horborder- -horborder)+-horborder,r=50*m-direction,t=.2<=p(),u="#015d00";1==t&&(u="#b3dd52");obstacle[m]=new Zdog.f({a:illo,width:32,height:96,frontFace:!1,j:!1,depth:8,stroke:8,l:20,color:u,translate:{x:q,y:r,z:50*t-25}});obstacle[m].b=!1}flipy=50*m-direction;console.log("Loaded level "+k.toString());v();
setInterval(function(){y(!1)},15);onkeydown=function(a){z(a.key)};var A=Math.max(1,Math.floor(.01*(window.innerWidth||document.body.clientWidth))),B=0,C=0,D=0,E=0,F=Math.tan(.375*Math.PI),G=document.getElementById("game");G.addEventListener("touchstart",function(a){B=a.changedTouches[0].screenX;C=a.changedTouches[0].screenY},!1);
G.addEventListener("touchend",function(a){D=a.changedTouches[0].screenX;E=a.changedTouches[0].screenY;a=D-B;var b=E-C,I=Math.abs(a/b),J=Math.abs(b/a);Math.abs(a)>A||Math.abs(b)>A?(J<=F&&(0>a?z("ArrowLeft"):z("ArrowRight")),I<=F&&(0>b?z("ArrowUp"):z("ArrowDown"))):z("Space")},!1);var l=1;function p(){var a=1E4*Math.sin(l++);return a-Math.floor(a)}
function y(a){for(var b=performance.now();0<e.length&&e[0]<=b-1E3;)e.shift();e.push(b);f=e.length;document.getElementById("fps-display").innerHTML=f.toString()+" fps";document.getElementById("seed-display").innerHTML=l.toString()+" seed";document.getElementById("level-display").innerHTML=level.toString()+" level";document.getElementById("cam-display").innerHTML=illo.rotate.x.toString()+"x  "+illo.rotate.y.toString()+"y  "+illo.rotate.x.toString()+"z  "+d.toString()+"tau";if(!paused||0!=a){cameray-=
direction;0<shakeduration?(illo.translate={x:0+shakex,y:cameray+shakey},--shakeduration):illo.translate={x:0,y:cameray};-1==flipped&&illo.rotate.x<d/16*7&&(illo.rotate.x+=d/16,bgcolor="#A7C06D");for(a=0;4!=a;a+=1)for(playerx+=playermovex/4,playerx>horborder&&(playerx=horborder,playermovex=0),playerx<-horborder&&(playerx=-horborder,playermovex=0),playery+=playermovey/4,playery>flipy&&(playery=flipy,flipped=-1,H([0,,.0371,,.3841,.3887,,.1299,,,,,,.566,,.4401,,,1,,,,,.71]),playermovey=-1),b=0;b!=obstacle.length;b++)xx=
obstacle[b].translate.x,yy=obstacle[b].translate.y,zz=obstacle[b].translate.z,w=obstacle[b].width-5,h=obstacle[b].height-20,(1==flipped&&25==zz||-1==flipped&&-25==zz)&&playerx>xx-w&&playerx<xx+w&&playery>yy-h&&playery<yy+h?0==obstacle[b].b&&(console.log("Collision detected with "+b.toString()),obstacle[b].b=!0,shakex=0<playermovex?5:0>playermovex?-5:0,playermovex=0,playermovey=1*flipped,shakeduration=2,H([0,,.035,,.1449+.5*p(),.4918,,-.5252,,,,,,.034,,,,,1,,,,,.5+.3*p()])):1==obstacle[b].b&&(console.log("Collision ended with "+
b.toString()),obstacle[b].b=!1,25==obstacle[b].translate.z?(obstacle[b].translate.z=-25,obstacle[b].color="#015d00"):(obstacle[b].translate.z=25,obstacle[b].color="#b3dd52"));v()}}
function z(a){console.log(a);"Escape"==a&&(paused=!paused);if(paused)if("f"==a&&y(!0)," "==a)v();else return;var b=0;if("ArrowLeft"==a||"a"==a||"q"==a)b=-1;if("ArrowRight"==a||"d"==a)b=1;0!=b&&0==playermovex&&(playermovex=8*b,playermovey=0,H([1,,.2159,.2603,.1064,.4074+.3*p(),.2062,-.3031,-.0065,.0638,.0206,-.0114,,.4332,.1898,,-.0074,-.0091,1,-.0456,,.1791,.0109,.5]));if("ArrowUp"==a||"w"==a||"z"==a)playermovex=0,playermovey=.5*flipped,H([0,,.0549,.0019,.1806,.3751+.3*p(),.0193,.2378,.0414,,.0453,
3E-4,,.3062,.0736,.0563,.014,.0768,.936,-.0341,.0175,.1448,.0321,.5]);if("ArrowDown"==a||"s"==a)playermovex=0,playermovey=3*flipped,H([1,,.2506,.0144,.0071,.4263+.2*p(),.2723,-.252,,,,,,.7952,-.6573,,.1965,-.182,1,,,,,.5])}function v(){player.translate={x:playerx,y:playery};var a=0;-1==flipped&&(a=-d/2);player.rotate={y:.08*-playermovex,x:-(.15*playermovey*flipped)+a};cameray=-flipped*player.translate.y*.935-100;illo.s()}window.addEventListener("resize",function(){g()});
function g(){illo.zoom=850<window.innerWidth&&600<window.innerHeight?2:600<window.innerWidth&&400<window.innerHeight?1.5:400<window.innerWidth&&300<window.innerHeight?1:.9;v()}function H(a){a=jsfxr(a);var b=new Audio;b.src=a;b.play()};